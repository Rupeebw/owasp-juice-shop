================================================================================
SIMPLE PIPELINE SETUP - SLASH COMMAND EXTENDED WITH DOCKER HUB PUSH
================================================================================

‚úÖ COMPLETED: /simple-pipeline-setup slash command extended with Docker Hub push

Location: /Users/rupeshpanwar/.claude/commands/simple-pipeline-setup.md
Size: ~18K (expanded with Docker Hub integration + PAT authentication)
Last Updated: 2025-11-24
Purpose: Extend existing 3-stage pipeline with Stage 4 (Push to Docker Hub)

================================================================================
SLASH COMMAND DETAILS
================================================================================

Name: /simple-pipeline-setup
Description: Interactive guided setup for GitHub Actions simple pipeline - training mode
Platform: GitHub Actions (NOT Jenkins)
Workflow: simple-pipeline.yml
Philosophy: Simple ‚Üí Secure ‚Üí Mature

================================================================================
WHAT IT DOES
================================================================================

Extends existing 3-stage pipeline with Docker Hub push through 7 interactive steps:

PREREQUISITE: Existing pipeline with 3 stages (Lint ‚Üí Test ‚Üí Build)

STEP 1: Setup Docker Hub PAT (NEW! - Authentication First)
  Sub-step 1.1: Create Docker Hub Personal Access Token
  - Guide user to https://hub.docker.com/settings/security
  - Generate new access token (github-actions-push)
  - Token format: dckr_pat_xxxxxxxxxxxxxxxxxxxxx
  - Copy token (only shown once!)

  Sub-step 1.2: Configure GitHub Secret
  - Go to GitHub repo ‚Üí Settings ‚Üí Secrets ‚Üí Actions
  - Add secret: DOCKER_PASSWORD
  - Value: Docker Hub PAT
  - Verify secret appears in list

STEP 2: Verify Existing Pipeline
- Check .github/workflows/simple-pipeline.yml exists
- Verify 3 stages present (lint, test, build)
- Confirm build stage creates artifact
- Stop if pipeline doesn't exist

STEP 3: Review Current Pipeline
- Show 3-stage structure (Lint ‚Üí Test ‚Üí Build)
- Explain adding Stage 4 (Push to Docker Hub)
- Confirm authentication configured
- Get user approval to proceed

STEP 4: Add Docker Hub Push Stage
- Ask Docker Hub username (default: rupeedev)
- Ask Docker repo name (default: app or juice-shop)
- Generate Stage 4 YAML code
- Add to existing workflow file
- Option 1: Manual edit (recommended)
- Option 2: Append via command

STEP 5: Test Locally (Optional but Recommended)
- Validate YAML syntax with yamllint
- Test Docker build
- Optional: Test Docker login locally
- Catch issues before pushing

STEP 6: Commit and Push Extended Pipeline
- Stage modified workflow file
- Commit: "Extend pipeline with Docker Hub push stage"
- Push to GitHub
- Trigger workflow run with all 4 stages

STEP 7: Validate Extended Pipeline in GitHub
- Check all 4 stages GREEN in GitHub Actions
- Verify Docker Hub push succeeds
- Check images on Docker Hub:
  * rupeedev/app:latest
  * rupeedev/app:{commit-sha}
  * rupeedev/app:simple
- View at: https://hub.docker.com/r/rupeedev/app

================================================================================
KEY FEATURES
================================================================================

‚úÖ Interactive & Educational
- Step-by-step guidance
- Validation at each step
- Explains what's happening
- Encourages learning

‚úÖ Project Type Aware
- Detects Node.js, Python, Java, etc.
- Generates appropriate workflow
- Customized build steps

‚úÖ Troubleshooting Built-in
- Common issues documented
- Fix commands provided
- Proactive error detection

‚úÖ Training-Focused
- Emphasizes Simple ‚Üí Secure ‚Üí Mature
- No premature optimization
- Green pipeline = success
- Foundation for Part 6

‚úÖ Consistent with /localstack-setup
- Same structure and flow
- Same interactive style
- Same validation approach
- Same supportive tone

‚úÖ Docker Hub Integration (NEW!)
- Production-ready container registry (free tier)
- Docker Hub PAT authentication (security best practice)
- GitHub Secrets for secure credential management
- Multiple image tags (latest, commit-sha, simple)
- Automated push on every commit
- Images accessible worldwide
- No licensing issues (unlike LocalStack ECR Pro)

================================================================================
STAGE 4 EXTENSION (WHAT GETS ADDED)
================================================================================

The slash command ADDS Stage 4 to your existing 3-stage pipeline:

EXISTING (Already in your pipeline):
  Stage 1: Lint ‚Üí Stage 2: Test ‚Üí Stage 3: Build

NEW (What gets added by slash command):

  # Stage 4: Push to Docker Hub (needs build)
  push-to-dockerhub:
    name: Push to Docker Hub
    runs-on: ubuntu-latest
    needs: build  # Depends on Stage 3
    env:
      DOCKER_USERNAME: rupeedev  # Customize to your username
      DOCKER_REPO: app           # Customize to your repo name

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Download Docker image artifact
        uses: actions/download-artifact@v4
        with:
          name: docker-image

      - name: Load Docker image
        run: docker load -i app-image.tar

      - name: Log in to Docker Hub
        uses: docker/login-action@v3
        with:
          username: ${{ env.DOCKER_USERNAME }}
          password: ${{ secrets.DOCKER_PASSWORD }}

      - name: Tag image for Docker Hub
        run: |
          docker tag app:latest $DOCKER_USERNAME/$DOCKER_REPO:latest
          docker tag app:latest $DOCKER_USERNAME/$DOCKER_REPO:${{ github.sha }}
          docker tag app:latest $DOCKER_USERNAME/$DOCKER_REPO:simple

      - name: Push image to Docker Hub
        run: |
          docker push $DOCKER_USERNAME/$DOCKER_REPO:latest
          docker push $DOCKER_USERNAME/$DOCKER_REPO:${{ github.sha }}
          docker push $DOCKER_USERNAME/$DOCKER_REPO:simple

      - name: Success message
        run: |
          echo "üéâ Pipeline completed! Images pushed to Docker Hub"
          echo "View at: https://hub.docker.com/r/$DOCKER_USERNAME/$DOCKER_REPO"

KEY: No security scanning yet! That's Part 6.
     But now we have Docker Hub deployment with production-ready authentication!

================================================================================
PHILOSOPHY EMPHASIZED
================================================================================

‚ùå WRONG APPROACH:
- Try to build perfect pipeline on day 1
- Add all security tools before testing basic deployment
- Get paralyzed by complexity
- Never ship anything

‚úÖ RIGHT APPROACH:
- Build simple pipeline that works (Part 3a) ‚Üê DONE
- Get green CI/CD running ‚Üê DONE
- Add Docker Hub deployment (Part 3b) ‚Üê WE ARE HERE
- Setup authentication FIRST ‚Üê SECURITY BEST PRACTICE
- THEN add security scanning layers (Part 6)
- THEN add production features (Part 8)

This is how real teams do it!

PIPELINE EVOLUTION:
Stage 1 (Lint) ‚Üí Stage 2 (Test) ‚Üí Stage 3 (Build) ‚Üí Stage 4 (Push to Docker Hub)

================================================================================
INTEGRATION WITH TRAINING
================================================================================

Part 2: LocalStack Setup
‚îî‚îÄ‚îÄ /localstack-setup ‚úÖ DONE

Part 3: Simple Pipeline
‚îî‚îÄ‚îÄ /simple-pipeline-setup ‚úÖ DONE (just created!)

Part 6: Security Scanning (Future)
‚îî‚îÄ‚îÄ /security-pipeline-setup (to be created)

Part 8: Mature Pipeline (Future)
‚îî‚îÄ‚îÄ /mature-pipeline-setup (to be created)

================================================================================
USAGE
================================================================================

To use the slash command:

1. Navigate to your project directory
   cd /path/to/your/project

2. Run the slash command
   /simple-pipeline-setup

3. Answer the question about project type
   "This is a Node.js/npm project" (for Juice Shop)

4. Follow the 6 interactive steps
   - Each step validates before proceeding
   - Troubleshooting help provided
   - Clear success indicators

5. End result
   - Docker Hub PAT created and configured
   - GitHub Secret DOCKER_PASSWORD set
   - .github/workflows/simple-pipeline.yml extended (4-stage pipeline)
   - Workflow pushed to GitHub
   - GREEN pipeline in GitHub Actions (all 4 stages)
   - Docker images pushed to Docker Hub
   - Viewable at https://hub.docker.com/r/rupeedev/app

================================================================================
NEXT STEPS
================================================================================

DONE:
1. ‚úÖ Updated /simple-pipeline-setup for pipeline extension (not creation)
2. ‚úÖ Added Docker Hub integration with PAT authentication
3. ‚úÖ Added Step 1: Docker Hub PAT setup (security-first approach)
4. ‚úÖ Extended to 7-step process (was 6 steps)
5. ‚úÖ Changed from LocalStack ECR to Docker Hub (no Pro license needed)
6. ‚úÖ Production-ready credential management with GitHub Secrets
7. ‚úÖ Multi-tag strategy (latest, commit-sha, simple)

LATER:
1. Create /security-pipeline-setup (Part 6)
   - Builds on simple-pipeline.yml
   - Adds CodeQL, Trivy, npm audit
   - Adds security gates

2. Create /mature-pipeline-setup (Part 8)
   - Multi-environment deployments
   - Approval workflows
   - Complete automation

3. Update training document
   - Reference /simple-pipeline-setup
   - Add usage examples
   - Include screenshots


READY TO TEST?
================================================================================

You can now:

1. Run /simple-pipeline-setup in Juice Shop directory
2. Follow the interactive guide
3. Get a GREEN GitHub Actions pipeline
4. Have working baseline for Part 6

üöÄ How to Use /simple-pipeline-setup

  Step 1: Navigate to Your Project Directory

  cd /Users/rupeshpanwar/Documents/AI-Projects/owasp-juice-shop

  Step 2: Invoke the Slash Command

  In Claude Code CLI, simply type:

  /simple-pipeline-setup

  Step 3: Answer the Initial Question

  The assistant will ask:

  "What type of project is this?"
  - Node.js/npm (like Juice Shop)
  - Python
  - Java/Maven
  - .NET
  - Other?

  For Juice Shop, answer: Node.js/npm or This is a Node.js/npm project

  Step 4: Follow the Interactive Guide

  The slash command will guide you through 6 steps:

  1. Step 1: Verify environment (Git, Docker, GitHub remote)
  2. Step 2: Create .github/workflows/ directory
  3. Step 3: Generate simple-pipeline.yml workflow
  4. Step 4: Test locally (optional but recommended)
  5. Step 5: Commit and push to GitHub
  6. Step 6: Validate GREEN pipeline in GitHub Actions

  Each step will:
  - Show you what to do
  - Provide copy-paste commands
  - Validate before proceeding
  - Help troubleshoot if issues

  ---
  Example Session:

  # In your terminal
  cd /Users/rupeshpanwar/Documents/AI-Projects/owasp-juice-shop

  # In Claude Code CLI
  /simple-pipeline-setup

  Expected interaction:
  Assistant: Welcome to Simple Pipeline Setup! I'll guide you through 5 steps...

  What type of project is this?
  - Node.js/npm (like Juice Shop)
  - Python
  - Java/Maven
  - .NET
  - Other?

  You: Node.js/npm

================================================================================
DOCKER HUB INTEGRATION DETAILS
================================================================================

WHY DOCKER HUB (Instead of LocalStack ECR):
‚ùå LocalStack ECR requires Pro subscription (not free)
‚úÖ Docker Hub free tier is sufficient
‚úÖ Production-ready container registry
‚úÖ Industry-standard solution
‚úÖ Images accessible from anywhere
‚úÖ No licensing restrictions

AUTHENTICATION SETUP (Step 1):

1. Create Docker Hub PAT:
   - Go to: https://hub.docker.com/settings/security
   - Click "New Access Token"
   - Token Description: "github-actions-push"
   - Access permissions: "Read, Write, Delete"
   - Copy token: dckr_pat_xxxxxxxxxxxxxxxxxxxxx
   - ‚ö†Ô∏è  Only shown once!

2. Configure GitHub Secret:
   - Go to: GitHub repo ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions
   - Click "New repository secret"
   - Name: DOCKER_PASSWORD
   - Value: [Paste Docker Hub PAT]
   - Save

CONFIGURATION IN WORKFLOW:

```yaml
env:
  DOCKER_USERNAME: rupeedev  # Your Docker Hub username
  DOCKER_REPO: app           # Your repository name

steps:
  - name: Log in to Docker Hub
    uses: docker/login-action@v3
    with:
      username: ${{ env.DOCKER_USERNAME }}
      password: ${{ secrets.DOCKER_PASSWORD }}
```

IMAGE TAGS CREATED:
- rupeedev/app:latest (always latest build)
- rupeedev/app:{commit-sha} (specific version)
- rupeedev/app:simple (training identifier)

VIEW IMAGES:
- Web UI: https://hub.docker.com/r/rupeedev/app
- Pull image: docker pull rupeedev/app:latest
- Use in K8s: image: rupeedev/app:latest

VALIDATED SETUP:
- ‚úÖ Docker Hub PAT created
- ‚úÖ GitHub Secret DOCKER_PASSWORD configured
- ‚úÖ Login action working
- ‚úÖ Multi-tag push successful
- ‚úÖ Images viewable on Docker Hub

================================================================================
WHAT'S NEXT?
================================================================================

The pipeline is now ready for:
1. Test the extension with your actual project
2. Validate Docker Hub push works end-to-end
3. Part 6: Security Scanning (add CodeQL, Trivy, npm audit)
4. Deploy from Docker Hub to K8s/ECS/Cloud Run
5. Production rollout with real deployments

Training Progress:
- Part 2: LocalStack Setup ‚Üí ‚úÖ DONE
- Part 3a: Simple Pipeline (3 stages) ‚Üí ‚úÖ DONE
- Part 3b: Docker Hub Extension (Stage 4) ‚Üí ‚úÖ DONE
- Part 6: Security Pipeline ‚Üí üìã TODO

KEY ACHIEVEMENTS:
- Security-first approach (PAT setup before pipeline)
- Production-ready credentials management
- Extension approach (not replacement)
- Multi-tag strategy for versioning
- No LocalStack licensing issues
- Industry-standard Docker Hub integration

================================================================================
END OF SUMMARY
================================================================================
